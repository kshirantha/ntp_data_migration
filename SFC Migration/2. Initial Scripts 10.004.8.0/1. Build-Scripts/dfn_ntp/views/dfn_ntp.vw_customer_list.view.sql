CREATE OR REPLACE FORCE VIEW dfn_ntp.vw_customer_list
(
    u01_id,
    u01_customer_no,
    u01_institute_id_m02,
    m02_name,
    u01_account_category_id_v01,
    acctype,
    u01_first_name,
    u01_first_name_lang,
    u01_second_name,
    u01_second_name_lang,
    u01_third_name,
    u01_third_name_lang,
    u01_last_name,
    u01_last_name_lang,
    u01_display_name,
    u01_display_name_lang,
    u01_gender,
    u01_title_id_v01,
    u01_marital_status_id_v01,
    u01_date_of_birth,
    u01_birth_country_id_m05,
    u01_birth_city_id_m06,
    u01_default_id_no,
    u01_default_id_type_m15,
    u01_default_id_type_txt,
    u01_default_id_type_txt_lang,
    u01_preferred_lang_id_v01,
    u01_is_ipo_customer,
    u01_is_black_listed,
    u01_created_by_id_u17,
    u01_created_date,
    u01_status_id_v01,
    status_description,
    v01_description_lang,
    u01_signup_location_id_m07,
    u01_service_location_id_m07,
    u01_relationship_mngr_id_m10,
    u01_grade,
    u01_black_listed_reason,
    u01_identification_code,
    u01_modified_by_id_u17,
    u01_modified_date,
    u01_status_changed_by_id_u17,
    u01_status_changed_date,
    u01_trading_enabled,
    u01_nationality_id_m05,
    nationalitycountry,
    u01_online_trading_enabled,
    trading,
    online_trading,
    u01_preferred_name,
    u01_preferred_name_lang,
    u01_full_name,
    u01_full_name_lang,
    u01_external_ref_no,
    u01_account_type_id_v01,
    u01_master_account_id_u01,
    u01_corp_client_type_id_v01,
    u01_corp_license_renewal_date,
    u01_corp_license,
    u01_corp_name_address_of_group,
    u01_corp_type_of_business,
    u01_corp_date_incorporation,
    u01_corp_country_id_m05,
    u01_corp_annual_turnover,
    u01_corp_region_id_m90,
    u01_corp_no_of_employees,
    u01_corp_regulatory_body,
    u01_corp_paid_up_capital,
    u01_corp_legal_form,
    u01_corp_general_partner,
    u01_corp_investors,
    u01_swap_master,
    u01_ib_id_m21,
    acccategory,
    u01_poa_available_desc,
    u01_poa_available,
    u01_minor_account,
    minor_account,
    u01_guardian_id_u01,
    u01_signup_date,
    guardian_name,
    guardian_customer_no,
    u01_guardian_relationship_v01,
    guardian_relationship,
    u01_is_qualified_investor,
    u01_vat_waive_off,
    u01_vat_waive_off_desc,
    u01_tax_ref,
    u01_status_changed_reason,
    default_mobile,
    default_email,
    u02_fax,
    u02_zip_code,
    u02_po_box,
    u02_address_line1,
    u02_address_line1_lang,
    u02_address_line2,
    u02_address_line2_lang,
    u02_building_no,
    u02_unit_no,
    u02_additional_code,
    u02_district,
    u02_district_lang,
    contract_country,
    contract_country_lang,
    contract_city,
    contract_city_lang,
    u01_subfee_waiveoff_grp_id,
    m02_primary_institute_id_m02,
    u01_referral_cash_acc_id_u06,
    u01_incentive_group_id_m162,
    referred_cash_account,
    u01_direct_dealing_enabled,
    u01_dd_reference_no,
    u01_dd_from_date,
    u01_dd_to_date,
    u01_is_institutional_client,
    u01_agent_type,
    u01_agent_code,
    u01_investor_id,
    u01_category_v01
)
AS
    SELECT u01.u01_id,
           u01.u01_customer_no,
           u01.u01_institute_id_m02,
           m02.m02_name,
           u01.u01_account_category_id_v01,
           CASE
               WHEN u01.u01_account_type_id_v01 = 2 THEN 'Sub A/C'
               WHEN u01.u01_account_type_id_v01 = 1 THEN 'Master A/C'
           END
               AS acctype,
           u01.u01_first_name,
           u01.u01_first_name_lang,
           u01.u01_second_name,
           u01.u01_second_name_lang,
           u01.u01_third_name,
           u01.u01_third_name_lang,
           u01.u01_last_name,
           u01.u01_last_name_lang,
           u01.u01_display_name,
           u01.u01_display_name_lang,
           u01.u01_gender,
           u01.u01_title_id_v01,
           u01.u01_marital_status_id_v01,
           u01.u01_date_of_birth,
           u01.u01_birth_country_id_m05,
           u01.u01_birth_city_id_m06,
           u01.u01_default_id_no,
           u01.u01_default_id_type_m15,
           m15.m15_name AS u01_default_id_type_txt,
           m15.m15_name_lang AS u01_default_id_type_txt_lang,
           u01.u01_preferred_lang_id_v01,
           u01.u01_is_ipo_customer,
           u01.u01_is_black_listed,
           u01.u01_created_by_id_u17,
           u01.u01_created_date,
           u01.u01_status_id_v01,
           status.v01_description AS status_description,
           status.v01_description_lang,
           u01.u01_signup_location_id_m07,
           u01.u01_service_location_id_m07,
           u01.u01_relationship_mngr_id_m10,
           u01.u01_grade,
           u01.u01_black_listed_reason,
           u01.u01_identification_code,
           u01.u01_modified_by_id_u17,
           u01.u01_modified_date,
           u01.u01_status_changed_by_id_u17,
           u01.u01_status_changed_date,
           u01.u01_trading_enabled,
           u01.u01_nationality_id_m05,
           nationality.m05_name AS nationalitycountry,
           u01.u01_online_trading_enabled,
           CASE WHEN u01.u01_trading_enabled = 1 THEN 'Yes' ELSE 'No' END
               AS trading,
           CASE
               WHEN u01.u01_online_trading_enabled = 1 THEN 'Yes'
               ELSE 'No'
           END
               AS online_trading,
           u01.u01_preferred_name,
           u01.u01_preferred_name_lang,
           u01.u01_full_name,
           u01.u01_full_name_lang,
           u01.u01_external_ref_no,
           u01.u01_account_type_id_v01,
           u01.u01_master_account_id_u01,
           u01.u01_corp_client_type_id_v01,
           u01.u01_corp_license_renewal_date,
           u01.u01_corp_license,
           u01.u01_corp_name_address_of_group,
           u01.u01_corp_type_of_business,
           u01.u01_corp_date_incorporation,
           u01.u01_corp_country_id_m05,
           u01.u01_corp_annual_turnover,
           u01.u01_corp_region_id_m90,
           u01.u01_corp_no_of_employees,
           u01.u01_corp_regulatory_body,
           u01.u01_corp_paid_up_capital,
           u01.u01_corp_legal_form,
           u01.u01_corp_general_partner,
           u01.u01_corp_investors,
           u01.u01_swap_master,
           u01.u01_ib_id_m21,
           CASE
               WHEN u01.u01_account_category_id_v01 = 1 THEN 'Individual'
               WHEN u01.u01_account_category_id_v01 = 2 THEN 'Corporate'
           END
               AS acccategory,
           DECODE (u01.u01_poa_available,  1, 'Yes',  0, 'No')
               AS u01_poa_available_desc,
           u01.u01_poa_available,
           u01.u01_minor_account,
           CASE WHEN u01.u01_minor_account = 1 THEN 'Yes' ELSE 'No' END
               AS minor_account,
           u01.u01_guardian_id_u01,
           u01.u01_signup_date,
           guardian.u01_display_name AS guardian_name,
           guardian.u01_customer_no AS guardian_customer_no,
           u01.u01_guardian_relationship_v01,
           CASE
               WHEN u01.u01_guardian_relationship_v01 = 1 THEN 'Father'
               WHEN u01.u01_guardian_relationship_v01 = 2 THEN 'Mother'
               WHEN u01.u01_guardian_relationship_v01 = 3 THEN 'Uncle'
               WHEN u01.u01_guardian_relationship_v01 = 4 THEN 'Aunt'
           END
               AS guardian_relationship,
           u01.u01_is_qualified_investor,
           u01.u01_vat_waive_off,
           DECODE (u01.u01_vat_waive_off, 1, 'Yes', 'No')
               AS u01_vat_waive_off_desc,
           u01.u01_tax_ref,
           u01.u01_status_changed_reason,
           u02.u02_mobile AS default_mobile,
           u02.u02_email AS default_email,
           u02.u02_fax,
           u02.u02_zip_code,
           u02.u02_po_box,
           u02.u02_address_line1,
           u02.u02_address_line1_lang,
           u02.u02_address_line2,
           u02.u02_address_line2_lang,
           u02.u02_building_no,
           u02.u02_unit_no,
           u02.u02_additional_code,
           u02.u02_district,
           u02.u02_district_lang,
           m05.m05_name AS contract_country,
           m05.m05_name_lang AS contract_country_lang,
           m06.m06_name AS contract_city,
           m06.m06_name_lang AS contract_city_lang,
           u01.u01_subfee_waiveoff_grp_id,
           m02.m02_primary_institute_id_m02,
           u01.u01_referral_cash_acc_id_u06,
           u01.u01_incentive_group_id_m162,
           u06.u06_display_name AS referred_cash_account,
           u01.u01_direct_dealing_enabled,
           u01.u01_dd_reference_no,
           u01.u01_dd_from_date,
           u01.u01_dd_to_date,
           u01.u01_is_institutional_client,
           u01.u01_agent_type,
           u01.u01_agent_code,
           u01.u01_investor_id,
           u01.u01_category_v01
      FROM u01_customer u01
           LEFT JOIN u02_customer_contact_info u02
               ON u01.u01_id = u02.u02_customer_id_u01 AND u02_is_default = 1
           LEFT JOIN m06_city m06
               ON u02.u02_city_id_m06 = m06.m06_id
           LEFT JOIN m05_country m05
               ON u02.u02_country_id_m05 = m05.m05_id
           LEFT JOIN u01_customer guardian
               ON u01.u01_guardian_id_u01 = guardian.u01_id
           JOIN m15_identity_type m15
               ON u01.u01_default_id_type_m15 = m15.m15_id
           JOIN v01_system_master_data status
               ON     u01.u01_status_id_v01 = status.v01_id
                  AND status.v01_type = 4
           JOIN m05_country nationality
               ON u01.u01_nationality_id_m05 = nationality.m05_id
           JOIN m02_institute m02
               ON u01.u01_institute_id_m02 = m02.m02_id
           LEFT JOIN u06_cash_account u06
               ON u01.u01_referral_cash_acc_id_u06 = u06.u06_id
/
