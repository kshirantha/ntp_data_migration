CREATE OR REPLACE FORCE VIEW dfn_ntp.vw_t06_pending_cash_trnsctins
(
    t06_id,
    t06_cash_acc_id_u06,
    t06_code,
    action,
    t06_date,
    t06_from_cust_id_u01,
    t06_narration,
    t06_payment_method,
    payment_method,
    t06_transaction_currency_m03,
    t06_amt_in_txn_currency,
    t06_settle_currency_rate_m04,
    t06_cheque_no,
    t06_cheque_date,
    t06_settlement_date,
    t06_beneficiary_id_u08,
    t06_other_cash_acc_id_u06,
    t06_entered_by_id_u17,
    t06_entered_date,
    t06_last_changed_by_id_u17,
    t06_last_changed_date,
    t06_cash_log_acc_id_u30,
    t06_status_id,
    t06_bank_id_m93,
    t06_acc_name,
    t06_branch,
    t06_type_id,
    t06_chk_printed_by,
    t06_chk_printed_date,
    t06_extrnl_ref,
    t06_request_channel,
    t06_location,
    t06_auto_generate,
    t06_available_buy_power,
    t06_online_ft,
    t06_ft_status,
    t06_message_type,
    t06_stp_type,
    t06_stp_status,
    t06_stp_narration,
    t06_cust_bank_acc_id,
    t06_settlement_key,
    t06_txn_type,
    t06_reversed_by_id_u17,
    t06_reversed_date,
    t06_payment_initiated_time,
    t06_settle_currency_code_m03,
    t06_amt_in_settle_currency,
    t06_related_txn_id,
    t06_overdrawn_amt,
    t06_poa_id_u47,
    t06_exchange_fee,
    t06_broker_fee,
    t06_thirdparty_fee,
    t06_to_cash_acc_id,
    t06_client_channel_id_v29,
    t06_sub_login_id_u09,
    t06_sub_login_name,
    t06_b2b_txn_id_m97,
    t06_bypass_txn_restriction,
    t06_third_party_txn_id,
    t06_is_live,
    t06_no_of_approval,
    t06_current_approval_level,
    t06_deposit_bank_id_m16,
    t06_deposit_bank_no,
    from_transaction_id,
    to_transaction_id,
    u06_investment_account_no,
    u06_display_name,
    u06_currency_code_m03,
    basecurrency,
    u06_balance_from,
    u06_external_ref_no,
    to_cash_acc_id,
    u06_balance_to,
    to_u06_investment_acc_no,
    u06_currency_to,
    rec_u06_external_reference,
    u01_id,
    custid,
    u01_external_ref_no,
    custname,
    custnamelang,
    u01_preferred_lang_id_v01,
    u01_nationality_id_m05,
    u01_customer_no,
    m97_description,
    custbank,
    cust_bank_swift_code,
    enteredby,
    lastchangedby,
    m02_id,
    m02_code,
    bankaccount,
    our_bank_account,
    our_bank_branch,
    our_bank_address,
    ourbank,
    our_bank_swift_code,
    cust_trans_bank_name,
    cust_trans_bank_swift_code,
    status,
    online_ft_status,
    available_buy_power,
    stp_type_detail,
    t06_stp_status_detail,
    u08_account_no,
    u08_account_type_v01_id,
    account_type,
    u08_account_name,
    t06_brk_vat,
    t06_exg_vat
)
AS
    SELECT a.t06_id,
           a.t06_cash_acc_id_u06,
           a.t06_code,
           CASE a.t06_code
               WHEN 'CSHTRN' THEN 'Cash Transfer'
               WHEN 'REVBUY' THEN 'Reverse Buy'
               WHEN 'SUBFEE' THEN 'Subscription Fee'
               WHEN 'DEPOST' THEN 'Deposit'
               WHEN 'WITHDR' THEN 'Withdraw'
           END
               AS action,
           a.t06_date,
           a.t06_from_cust_id_u01,
           a.t06_narration,
           a.t06_payment_method,
           CASE a.t06_payment_method
               WHEN '1' THEN 'Cash'
               WHEN '2' THEN 'Cheque'
               WHEN '3' THEN 'Transfer'
           END
               AS payment_method,
           a.t06_transaction_currency_m03,
           a.t06_amt_in_txn_currency,
           a.t06_settle_currency_rate_m04,
           a.t06_cheque_no,
           a.t06_cheque_date,
           a.t06_settlement_date,
           a.t06_beneficiary_id_u08,
           a.t06_other_cash_acc_id_u06,
           a.t06_entered_by_id_u17,
           a.t06_entered_date,
           a.t06_last_changed_by_id_u17,
           a.t06_last_changed_date,
           a.t06_cash_log_acc_id_u30,
           a.t06_status_id,
           a.t06_bank_id_m93,
           a.t06_acc_name,
           a.t06_branch,
           a.t06_type_id,
           a.t06_chk_printed_by,
           a.t06_chk_printed_date,
           a.t06_extrnl_ref,
           a.t06_request_channel,
           a.t06_location,
           a.t06_auto_generate,
           a.t06_available_buy_power,
           a.t06_online_ft,
           a.t06_ft_status,
           a.t06_message_type,
           a.t06_stp_type,
           a.t06_stp_status,
           a.t06_stp_narration,
           a.t06_cust_bank_acc_id,
           a.t06_settlement_key,
           a.t06_txn_type,
           a.t06_reversed_by_id_u17,
           a.t06_reversed_date,
           a.t06_payment_initiated_time,
           a.t06_settle_currency_code_m03,
           a.t06_amt_in_settle_currency,
           a.t06_related_txn_id,
           a.t06_overdrawn_amt,
           a.t06_poa_id_u47,
           a.t06_exchange_fee,
           a.t06_broker_fee,
           a.t06_thirdparty_fee,
           a.t06_to_cash_acc_id,
           a.t06_client_channel_id_v29,
           a.t06_sub_login_id_u09,
           a.t06_sub_login_name,
           a.t06_b2b_txn_id_m97,
           a.t06_bypass_txn_restriction,
           a.t06_third_party_txn_id,
           a.t06_is_live,
           a.t06_no_of_approval,
           a.t06_current_approval_level,
           a.t06_deposit_bank_id_m16,
           a.t06_deposit_bank_no,
           a.from_transaction_id,
           a.to_transaction_id,
           a.u06_investment_account_no,
           a.u06_display_name,
           a.u06_currency_code_m03,
           a.basecurrency,
           a.u06_balance_from,
           a.u06_external_ref_no,
           a.to_cash_acc_id,
           a.u06_balance_to,
           a.to_u06_investment_acc_no,
           a.u06_currency_to,
           a.rec_u06_external_reference,
           a.u01_id,
           a.custid,
           a.u01_external_ref_no,
           a.custname,
           a.custnamelang,
           a.u01_preferred_lang_id_v01,
           a.u01_nationality_id_m05,
           a.u01_customer_no,
           a.m97_description,
           a.custbank,
           a.cust_bank_swift_code,
           a.enteredby,
           a.lastchangedby,
           a.m02_id,
           a.m02_code,
           a.bankaccount,
           a.our_bank_account,
           a.our_bank_branch,
           a.our_bank_address,
           a.ourbank,
           a.our_bank_swift_code,
           a.cust_trans_bank_name,
           a.cust_trans_bank_swift_code,
           a.status,
           a.online_ft_status,
           a.available_buy_power,
           a.stp_type_detail,
           a.t06_stp_status_detail,
           a.u08_account_no,
           a.u08_account_type_v01_id,
           a.account_type,
           a.u08_account_name,
           a.t06_brk_vat,
           a.t06_exg_vat
      FROM vw_t06_cash_transactions a
     WHERE    a.t06_status_id = 1
           OR (a.t06_status_id > 100 AND a.t06_status_id < 111)
/

DROP VIEW dfn_ntp.vw_t06_pending_cash_trnsctins
/
