CREATE OR REPLACE FORCE VIEW dfn_ntp.vw_t17_trade_process_requests
(
    t17_date,
    t17_id,
    t17_ord_no_t01,
    t17_cl_ord_id_t01,
    t17_avg_price,
    t17_quantity,
    t17_side,
    order_side,
    t17_ord_value,
    t17_commission,
    t17_exec_brk_commission,
    t17_broker_commission,
    t17_netstl,
    t17_net_value,
    t17_broker_tax,
    t17_exchange_tax,
    t17_status_id_v01,
    t17_symbol_code_m20,
    t17_tenant_code,
    t17_institution_id_m02,
    t17_exchange_code_m01,
    t17_cash_settle_date,
    t17_holding_settle_date,
    t17_status_changed_date,
    t17_status_changed_by,
    t17_old_avg_price,
    t17_old_quantity,
    t17_old_ord_value,
    t17_old_commission,
    t17_old_exec_brk_commission,
    t17_old_broker_commission,
    t17_old_netstl,
    t17_old_net_value,
    t17_old_broker_tax,
    t17_old_exchange_tax,
    t17_old_cash_settle_date,
    t17_old_holding_settle_date,
    t17_settle_currency_rate,
    t17_old_settle_currency_rate,
    v01_description,
    v01_description_lang,
    t17_order_date,
    t17_old_order_date,
    t17_old_order_avg_price,
    t17_order_avg_price,
    t17_old_cum_net_value,
    t17_cum_net_value,
    t17_old_cum_net_sttle,
    t17_cum_net_sttle,
    t17_old_cum_qty,
    t17_cum_qty,
    t17_old_cum_comm,
    t17_cum_comm,
    t17_trade_confirm_no_t02,
    t17_update_type,
    t17_no_of_approval,
    t17_current_approval_level,
    t01_customer_id_u01
)
AS
      SELECT t17_date,
             t17_id,
             t17_ord_no_t01,
             t17_cl_ord_id_t01,
             t17_avg_price,
             t17_quantity,
             t17_side,
             CASE t17.t17_side WHEN 1 THEN 'Buy' ELSE 'Sell' END AS order_side,
             t17_ord_value,
             t17_commission,
             t17_exec_brk_commission,
             t17_broker_commission,
             t17_netstl,
             t17_net_value,
             t17_broker_tax,
             t17_exchange_tax,
             t17_status_id_v01,
             t17_symbol_code_m20,
             t17_tenant_code,
             t17_institution_id_m02,
             t17_exchange_code_m01,
             t17_cash_settle_date,
             t17_holding_settle_date,
             t17_status_changed_date,
             t17_status_changed_by,
             t17_old_avg_price,
             t17_old_quantity,
             t17_old_ord_value,
             t17_old_commission,
             t17_old_exec_brk_commission,
             t17_old_broker_commission,
             t17_old_netstl,
             t17_old_net_value,
             t17_old_broker_tax,
             t17_old_exchange_tax,
             t17_old_cash_settle_date,
             t17_old_holding_settle_date,
             t17_settle_currency_rate,
             t17_old_settle_currency_rate,
             v01.v01_description,
             v01.v01_description_lang,
             t17_order_date,
             t17_old_order_date,
             t17_old_order_avg_price,
             t17_order_avg_price,
             t17_old_cum_net_value,
             t17_cum_net_value,
             t17_old_cum_net_sttle,
             t17_cum_net_sttle,
             t17_old_cum_qty,
             t17_cum_qty,
             t17_old_cum_comm,
             t17_cum_comm,
             t17_trade_confirm_no_t02,
             t17_update_type,
             t17_no_of_approval,
             t17_current_approval_level,
             t01_customer_id_u01
        FROM t17_trade_processing_requests t17
             LEFT JOIN t01_order t01
                 ON t17.t17_cl_ord_id_t01 = t01.t01_cl_ord_id
             LEFT JOIN (SELECT *
                          FROM v01_system_master_data
                         WHERE v01_type = 4) v01
                 ON t17.t17_status_id_v01 = v01.v01_id
    ORDER BY t17_cl_ord_id_t01 DESC
/
